webpackJsonp(["3534f79d5881665f9ca38e5c0bceeb60"],{"./src/components/App/App.css":function(){},"./src/components/App/App.jsx":function(b,d,e){"use strict";function f(){return Object(D.a)("header",{id:"header-bar"},"HeightMap")}function h(a){D.b.__h&&D.b.__h(B);var b=B.__H||(B.__H={t:[],u:[]});return a>=b.t.length&&b.t.push({}),b.t[a]}function a(a){return j(p,a)}function j(a,b,c){var d=h(A++);return d.__c||(d.__c=B,d.i=[c?c(b):p(void 0,b),function(b){var c=a(d.i[0],b);d.i[0]!==c&&(d.i[0]=c,d.__c.setState({}))}]),d.i}function k(a,b){var c=h(A++);g(c.o,b)&&(c.i=a,c.o=b,B.__H.u.push(c))}function l(){K.some(function(a){a.__P&&(a.__H.u.forEach(m),a.__H.u.forEach(o),a.__H.u=[])}),K=[]}function m(a){a.m&&a.m()}function o(a){var b=a.i();"function"==typeof b&&(a.m=b)}function g(a,b){return!a||b.some(function(b,c){return b!==a[c]})}function p(a,b){return"function"==typeof b?b(a):b}function n(a){a.name=a.name.replace(",","-"),P.entries=P.entries.concat(a),O.push(a.name),P.onChange.forEach((a)=>a(P)),q(a)}function q(a){P.selectedEntry=a,P.onChange.forEach((a)=>a(P))}function r(a){k(()=>{a.onChange&&(a.onChange(P),P.onChange.push(()=>a.onChange(P)))},[])}function s(){function b(a){q(a)}var c=a([]),d=Q(c,2);const e=d[0],f=d[1];return r({onChange:(a)=>{f(a.getEntries())}}),Object(D.a)("nav",{id:"side-panel"},Object(D.a)("ul",null,e.map((a)=>Object(D.a)("li",null,Object(D.a)("button",{class:"side-panel-item",onClick:()=>b(a)},a.name)))))}function t(){return Object(D.a)("div",{id:"file-upload"},Object(D.a)("input",{type:"file",multiple:!0,name:"dbalti",onChange:function(a){for(let b=0;b<a.target.files.length;b++){const c=a.target.files[b],d=new FileReader;d.onload=function(a){n({name:c.name,size:c.size,content:a.target.result})},d.readAsText(c)}}}))}function u(a){if(R.get(a))return R.get(a);const b=a.split("\n"),c=b.reduce((a,b)=>{if(!b)return a;if(b.startsWith("ncols"))a.ncols=parseInt(b.replace("ncols","").trim(),10);else if(b.startsWith("nrows"))a.nrows=parseInt(b.replace("nrows","").trim(),10);else if(b.startsWith("xllcorner"))a.xllcorner=parseInt(b.replace("xllcorner","").trim(),10);else if(b.startsWith("yllcorner"))a.yllcorner=parseInt(b.replace("yllcorner","").trim(),10);else if(b.startsWith("cellsize"))a.cellsize=parseInt(b.replace("cellsize","").trim(),10);else if(b.startsWith("NODATA_value"))a.NODATA=parseInt(b.replace("NODATA_value","").trim(),10);else{const c=b.split(" ").filter(Boolean).map((a)=>parseInt(a,10)),d=c.reduce((b,c)=>((!a.min||c<a.min)&&(a.min=c),(!a.max||c>a.max)&&(a.max=c),b+c),0)/c.length;a.values.push(c),a.average+=d}return a},{values:[],average:0,min:!1,max:!1});return c.average/=c.nrows,R.set(a,c),c}function v(){var a=function(){return(0|65536*(1+Math.random())).toString(16).substring(1)};return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}function w(a){let b=v();return k(()=>{var c=Math.floor;if(a.entry){const g=u(a.entry.content);if(0!==g.values.length){const a=[].concat(...g.values),h=new Uint8ClampedArray(4*(g.ncols*g.nrows));for(let b=0;b<h.length;b+=4)h[b+0]=c(a[b/4]),h[b+1]=c(a[b/4]),h[b+2]=c(a[b/4]),h[b+3]=255;const i=new ImageData(h,g.ncols);var d=document.getElementById(b),e=document.createElement("canvas");e.width=g.ncols,e.height=g.nrows;var f=e.getContext("2d");return f.putImageData(i,0,0),d.appendChild(e),()=>{d.removeChild(e)}}}},[a.entry]),Object(D.a)("div",{class:"canvas",id:b})}function x(a,b){var c=Math.PI,d=Math.tanh,e=Math.atanh,f={GRS80E:0.081819191042816,LONG_0:3,XS:7e5,YS:12655612.0499,n:0.725607765053267,C:11754255.4261},g=a-f.XS,h=b-f.YS,i=Math.atan(-g/h),j=Math.sqrt(g*g+h*h),k=Math.log(f.C/j)/f.n,l=d(k+f.GRS80E*e(0.8414709848078965*f.GRS80E)),m=d(k+f.GRS80E*e(f.GRS80E*l)),n=d(k+f.GRS80E*e(f.GRS80E*m)),o=d(k+f.GRS80E*e(f.GRS80E*n)),p=d(k+f.GRS80E*e(f.GRS80E*o)),q=d(k+f.GRS80E*e(f.GRS80E*p)),r=d(k+f.GRS80E*e(f.GRS80E*q)),s=Math.asin(r),t=i/f.n+f.LONG_0/180*c;return[180*(s/c),180*(t/c)]}function y(b){var c=a({}),d=W(c,2);const e=d[0],f=d[1];var g=a([]),h=W(g,2);const i=h[0],j=h[1];return k(()=>{const a=b.entries||[];if(e.map)e.geoJSON.forEach((a)=>a.remove()),e.geoJSON=[],a.forEach((a)=>{const b=u(a.content),c=x(b.xllcorner,b.yllcorner);e.map.setView(c,10);const d={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[c[1],c[0]],[c[1],c[0]+Y],[c[1]+X,c[0]+Y],[c[1]+X,c[0]],[c[1],c[0]]]]}}]};console.log(JSON.stringify(d)),e.geoJSON.push(L.geoJSON(d).addTo(e.map))});else{const a=L.map("leaflet").setView([51.505,-0.09],13),b=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors"}).addTo(a);f({map:a,layer:b,geoJSON:[]})}},[b.entries]),Object(D.a)("div",null,Object(D.a)("div",{id:"leaflet"}))}function z(){var b=a([]),c=Z(b,2);const d=c[0],e=c[1];return r({onChange(a){e(a.entries)}}),Object(D.a)("div",{id:"content"},Object(D.a)("h1",null,"From DB Alti to HeightMap"),Object(D.a)("p",null,"To start you can select the files from your dbalti you want to transform into heightmap. Only the \".asc\" extension is supported "),Object(D.a)("p",null,"The asc form is a text file which start with one param per line then one line per row of data."),Object(D.a)("form",null,Object(D.a)(t,null),Object(D.a)(y,{entries:d}),d.map((a)=>Object(D.a)(w,{key:a.name,entry:a}))))}Object.defineProperty(d,"__esModule",{value:!0});var A,B,C,D=e("./node_modules/preact/dist/preact.module.js"),E=e("./src/components/App/App.css"),F=e.n(E),G=e("./src/components/App/HeaderBar/HeaderBar.css"),H=e.n(G),I=e("./src/components/App/SidePanel/SidePanel.css"),J=e.n(I),K=[],i=D.b.__r,M=D.b.diffed,N=D.b.__c,c=D.b.unmount;D.b.__r=function(a){i&&i(a),A=0,(B=a.__c).__H&&(B.__H.u.forEach(m),B.__H.u.forEach(o),B.__H.u=[])},D.b.diffed=function(a){M&&M(a);var b=a.__c;if(b){var c=b.__H;c&&c.u.length&&(1!==K.push(b)&&C===D.b.requestAnimationFrame||((C=D.b.requestAnimationFrame)||function(a){var b,c=function(){clearTimeout(d),cancelAnimationFrame(b),setTimeout(a)},d=setTimeout(c,100);"undefined"!=typeof window&&(b=requestAnimationFrame(c))})(l))}},D.b.__c=function(a,b){b.some(function(a){a.__h.forEach(m),a.__h=a.__h.filter(function(a){return!a.i||o(a)})}),N&&N(a,b)},D.b.unmount=function(a){c&&c(a);var b=a.__c;if(b){var d=b.__H;d&&d.t.forEach(function(a){return a.m&&a.m()})}};let O=[];const P={entries:function(){return O=(localStorage.getItem("heighmap-keys")||"").split(",").filter(Boolean),O.reduce((a,b)=>a.concat({name:b,content:localStorage.getItem(b)||""}),[])}(),onAdd:[],onChange:[],getEntries(){return this.entries}};var Q=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();const R=new Map;var S=e("./src/components/App/Image/Image.css"),T=e.n(S),U=e("./src/components/App/Map/Map.css"),V=e.n(U),W=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();const X=0.03,Y=0.02;var Z=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();d["default"]=function(){return Object(D.a)("div",{id:"app"},Object(D.a)(f,null),Object(D.a)(s,null),Object(D.a)(z,null))};`

`},"./src/components/App/HeaderBar/HeaderBar.css":function(){},"./src/components/App/Image/Image.css":function(){},"./src/components/App/Map/Map.css":function(){},"./src/components/App/SidePanel/SidePanel.css":function(){}});